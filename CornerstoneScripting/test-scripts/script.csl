ruleset sss
// ddff
execute(Date startDate) {
   assert startDate:isNull();
   def String s1 = "sdsdsd";
   def Ddouble d1 = 42.0;
   def Integer y = 0;
   def dynamic Integer z = (1 + y * 100);
   foreach (i in 1 to 300) {
      y = 2 * i;
   }

   /**
    * sdssd
    */
   y = utils$runAgg(y, 2);

   def Integer idx = 0;
   while (idx < 10) {
      idx = idx + 1;
   }
   
   def Date dt;
   dt:setNow(2);
   def dynamic String xxx = "The date is " | dt ;
   foreach (i in 1 to 10) {
      dt:incrementDays(1);
   }
   
   return "Value of z is " | z | newLine | dt | newLine | xxx;
}

ruleset utils

crapola(Date startDate) {
    def dynamic String sql1 = "SELECT date(ymdh) as day, sum(imps) as vertica_imps, sum(clicks) as clicks, " |
                  "sum(convs) as convs, sum(media_cost_dollars) as buyer_media_cost, " |
                  "sum(reseller_revenue) as seller_revenue, sum(booked_revenue_dollars) as booked_revenue " |
                  "FROM agg_dw_billing_adjusted WHERE date(ymdh) = '" | startDate | "' and adjustment_id = 0 " |
                  "group by day order by day";

}

runAgg(Integer aggno, Integer incr) {
   return aggno * 10 * incr;
}

